
from Crypt.Util.number import bytes_to_long, long_to_bytes

# Input values
message_hex = "0297C5C81B8B1313B72570DACCBD10113E0AA6BF0E54F13FD54D5A7905820EA5FD8846307FD5A2A05F4EC2D39F0DDEFB0C9E3E3A2AB1E6C397338BE5A498C0AE12ED49328EA706CEB1C5B90A32E51526995E25878C3F9B206EB9BB1BCEA4FCF9527FABED7D2B8AB1F43956864D98994AC890023E5901656C2662952983AC333EBDB75AD87806C41CDD51F31D0A1F083175F8662EF106B7B6A4D4567D57638E9118AE80D4179DD19F08265CA453815908E43A0AE353CF4BA731C3250FD6698C635403C7A6E9B1710A019C99EA7FC200FEFDCAD27009BDB461CDCE0CBB604D9AFD0ADE93DCDD6E35F4F741AAA9900E965DC21CAD9335BBE00275800BEE46F5B0"


modulus_hex = "F28F7962030D968391484A273A90B86798AC7C399F97049D7F987C0B389159E51301B706D029B58E96C2781436B456EA6F5EF00DE17FEFE94EB4F990A22976884F3FA42518CEC959122E9326B84B301E3601C00DCEA54843B356ABE526684D0F0E04F8E1B7B2E0CCD5ED370663C800A4F8B229312A168044282049EFDDF0C722192DC75E199CF2F85AEF44FB3D4E329EA0CAE57A806F57EFA9BEF8E69B92B4858A7FEACAD9A5E2277468C16CA5670B0715672C379606C720196A806EBA9DCBF5AC7697B394A0BCCC0FEA48FDDF477CC61DEC7527469435B223F29D5433A9540A2F9843F2617A315456575628D390B4C01FE2B6A5D3CB61088D5FFC7379071B03"

exponent_hex = "10001"

M = bytes_to_long(bytes.fromhex(message_hex))
n = int(modulus_hex, 16)
e = int(exponent_hex, 16)

C = pow(M, e, n)

ciphertext = long_to_bytes(C)

# Print the encrypted message in hexadecimal format
print(ciphertext.hex())

